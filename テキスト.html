<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Geo-Explorer Pro V25 - Comprehensive Maps</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Leaflet Terminator (may require internet access) -->
    <script src="https://cdn.jsdelivr.net/npm/@joergdietrich/leaflet.terminator@0.1.2/dist/leaflet.terminator.min.js"></script>
    <!-- SunCalc Library for Sunrise/Sunset calculations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/suncalc/1.9.0/suncalc.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+JP:wght@400;500;700;900&display=swap" rel="stylesheet">

    <style>
        :root { --primary: #1a73e8; --accent: #ea4335; }
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; font-family: 'Inter', 'Noto Sans JP', sans-serif; overflow: hidden; background: #000; }
        #map { position: absolute; top: 0; left: 0; height: 100%; width: 100%; z-index: 10; background: #f0f0f0; }

        .glass-panel {
            background: rgba(255, 255, 255, 0.94);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
        }

        .top-controls { z-index: 9999; }
        .bottom-controls { z-index: 9999; }

        #sidePanel {
            position: absolute; top: 0; left: 0; bottom: 0; z-index: 10000;
            width: 420px; transition: transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
            display: flex; flex-direction: column; background: white;
            box-shadow: 10px 0 50px rgba(0,0,0,0.1);
            overflow-y: auto;
        }
        .panel-hidden { transform: translateX(-100%); }

        .action-btn {
            display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; padding: 10px;
            border-radius: 10px; font-weight: 700; font-size: 12px; transition: all 0.2s ease;
            background: #f8fafc; border: 1px solid #e2e8f0; color: #334155;
            cursor: pointer;
        }
        .action-btn.active-overlay {
            background: #eff6ff;
            border-color: #3b82f6;
            color: #1d4ed8;
        }
        .action-btn.active-base { background: #1a73e8; color: white; border-color: #1a73e8; }

        #layerMenu { scrollbar-width: none; }
        #layerMenu::-webkit-scrollbar { display: none; }

        .image-loader {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f1f5f9;
        }

        .close-panel-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 9500;
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-radius: 9999px;
            padding: 0.5rem;
            color: #4b5563;
            transition: all 0.2s;
            cursor: pointer;
        }
        .close-panel-btn:hover {
            color: #ef4444;
            transform: scale(1.1);
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(5px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-5px); }
        }
        .animate-tip {
            animation: fadeInOut 10s infinite;
        }

        .filter-grayscale { filter: grayscale(100%); }
        .filter-bw { filter: grayscale(100%) contrast(150%); }
        .filter-rader-blue { filter: sepia(100%) hue-rotate(170deg) saturate(300%) brightness(0.8) contrast(1.2); }

        .clock-label {
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 6px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            white-space: normal;
            word-wrap: break-word;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.4);
            text-align: center;
            pointer-events: none;
            line-height: 1.3;
            min-width: 110px;
            max-width: 160px;
            display: inline-block;
        }
        .clock-time {
            font-weight: 800;
            font-size: 1.1em;
            display: block;
            margin: 2px 0;
        }
        .clock-sun {
            font-size: 0.85em;
            opacity: 0.9;
            white-space: nowrap;
            display: block;
            margin-top: 2px;
            color: #fbbf24;
        }

        .quiz-option {
            width: 100%;
            text-align: left;
            padding: 14px 16px;
            background: white;
            border: 2px solid #f1f5f9;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            margin-bottom: 8px;
            line-height: 1.4;
            display: block;
            word-break: break-word;
            cursor: pointer;
        }
        .quiz-option:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
        }
        .quiz-option.correct {
            background: #dcfce7 !important;
            border-color: #22c55e !important;
            color: #15803d !important;
        }
        .quiz-option.incorrect {
            background: #fee2e2 !important;
            border-color: #ef4444 !important;
            color: #b91c1c !important;
        }

        .leaflet-control-scale {
            margin-bottom: 24px !important;
            margin-left: 12px !important;
        }
        .leaflet-control-scale-line {
            background: rgba(255, 255, 255, 0.7) !important;
            backdrop-filter: blur(4px);
            border: 2px solid #1a73e8 !important;
            border-top: none !important;
            color: #1a73e8 !important;
            font-weight: 800 !important;
            font-size: 10px !important;
            text-shadow: none !important;
        }

        @media (max-width: 640px) {
            #sidePanel { width: 100%; transform: translateY(100%); left: 0; top: auto; height: 85vh; border-radius: 32px 32px 0 0; }
            .panel-hidden { transform: translateY(100%) !important; }
            .close-panel-btn { top: 1.5rem; right: 1.5rem; }
            .leaflet-control-scale { margin-bottom: 30px !important; }
            #legendPanel { bottom: 3rem !important; max-width: 95vw !important; }
        }
    </style>
</head>
<body>

    <div class="top-controls fixed top-6 left-6 right-6 pointer-events-none flex items-center justify-between gap-4">
        <div class="w-14 shrink-0"></div>

        <form onsubmit="event.preventDefault(); performSearch();" class="glass-panel flex-1 max-w-lg h-14 rounded-2xl flex items-center px-4 pointer-events-auto">
            <button type="button" onclick="toggleSidePanel()" class="p-2 text-gray-400 hover:text-blue-600 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2.5" d="M4 6h16M4 12h16M4 18h16"/></svg>
            </button>
            <input type="text" id="searchInput" placeholder="å ´æ‰€ã‚’æ¤œç´¢..." class="flex-1 bg-transparent px-3 outline-none font-bold text-gray-800 text-sm">
            <button type="submit" id="searchBtn" class="bg-blue-600 text-white p-2.5 rounded-xl shadow-lg hover:bg-blue-700 transition-all">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="3" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
            </button>
        </form>

        <button onclick="toggleLayerMenu()" class="glass-panel w-14 h-14 rounded-2xl flex items-center justify-center text-gray-500 hover:text-blue-600 transition-all pointer-events-auto shrink-0">
            <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
        </button>
    </div>

    <div id="map"></div>

    <!-- Legend Panel -->
    <div id="legendPanel" class="fixed bottom-6 left-1/2 -translate-x-1/2 z-[5000] glass-panel px-4 py-3 rounded-2xl hidden shadow-2xl transition-all duration-300 max-w-[90vw]">
        <div id="legendTitle" class="text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2 text-center">å‡¡ä¾‹</div>
        <div id="legendContent" class="flex items-center gap-4 text-xs font-bold text-gray-700 whitespace-nowrap overflow-x-auto p-1">
            <!-- Dynamic Content -->
        </div>
    </div>

    <aside id="sidePanel" class="panel-hidden">
        <button onclick="closeSidePanel()" class="close-panel-btn">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2.5" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>

        <div id="imageSection" class="relative w-full h-64 bg-gray-100 shrink-0 overflow-hidden">
            <div id="poiImageLoader" class="image-loader">
                <div id="loaderText" class="text-gray-400 text-[10px] font-black uppercase tracking-widest">Searching Wikipedia...</div>
            </div>
            <img id="poiImage" class="w-full h-full object-cover hidden" alt="Location view">
            <div id="noImagePlaceholder" class="w-full h-full flex flex-col items-center justify-center bg-slate-50 text-slate-300 hidden">
                <svg class="w-12 h-12 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
                <span id="noImageText" class="text-[10px] font-bold uppercase tracking-widest">No Wikipedia Image</span>
            </div>
        </div>

        <div class="p-8 space-y-6 pb-20">
            <div class="space-y-4">
                <div><h2 id="poiName" class="text-3xl font-black text-gray-900 leading-tight">å ´æ‰€ã‚’é¸æŠ</h2></div>
                <div id="addressSection" class="bg-gray-50 p-4 rounded-2xl border border-gray-100">
                    <label id="labelAddr" class="text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-1">ğŸ“ ä½æ‰€</label>
                    <p id="addrText" class="text-sm font-bold text-gray-700 leading-relaxed"></p>
                </div>
                <div id="notFoundSection" class="hidden space-y-4 pt-2">
                    <p id="notFoundMsg" class="text-sm font-medium text-gray-600 leading-relaxed">æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«èª¤å­—ã‚„è„±å­—ãŒãªã„ã‹ã”ç¢ºèªãã ã•ã„ã€‚</p>
                    <button onclick="searchGoogleWeb()" id="searchGoogleBtn" class="action-btn active-base !justify-start px-4">ğŸ” Google æ¤œç´¢ã§æ¢ã™</button>
                </div>
            </div>

            <div id="wikiContainer" class="hidden space-y-2">
                <div class="flex items-center justify-between">
                    <label id="labelWiki" class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Wikipedia æ¦‚è¦</label>
                    <a id="wikiLink" href="#" target="_blank" class="text-[10px] font-bold text-blue-500 hover:underline">ã‚‚ã£ã¨è¦‹ã‚‹</a>
                </div>
                <p id="wikiText" class="text-sm leading-relaxed text-gray-600 font-medium"></p>
            </div>

            <div id="quizSection" class="hidden bg-purple-50 p-6 rounded-3xl border border-purple-100 space-y-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <div class="bg-purple-600 text-white p-1.5 rounded-lg">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2.5" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                        </div>
                        <label id="labelQuiz" class="text-[10px] font-black text-purple-600 uppercase tracking-widest">AI ã‚¯ã‚¤ã‚º</label>
                    </div>
                    <button onclick="generateQuiz()" id="refreshQuizBtn" class="text-[10px] font-bold text-purple-400 hover:text-purple-600 transition-colors">åˆ¥ã®å•é¡Œ</button>
                </div>

                <div id="quizLoading" class="hidden py-4 flex flex-col items-center justify-center space-y-2">
                    <div class="w-6 h-6 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin"></div>
                    <span id="quizLoadingText" class="text-[10px] font-bold text-purple-400 uppercase tracking-tighter text-center">AI ãŒã‚¯ã‚¤ã‚ºã‚’è€ƒãˆã¦ã„ã¾ã™...</span>
                </div>

                <div id="quizContent" class="space-y-4">
                    <p id="quizQuestion" class="text-sm font-bold text-purple-900 leading-relaxed"></p>
                    <div id="quizOptions" class="space-y-0"></div>
                </div>
            </div>

            <div id="tipSection" class="bg-blue-50/50 p-5 rounded-3xl border border-blue-100 flex items-start gap-3 overflow-hidden">
                <div class="bg-blue-600 text-white p-2 rounded-xl shrink-0">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="3" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                </div>
                <div class="space-y-1">
                    <label id="labelTip" class="text-[10px] font-black text-blue-400 uppercase tracking-widest">æ¢ç´¢ã®ãƒ’ãƒ³ãƒˆ</label>
                    <div id="tipContainer"><p id="tipText" class="text-xs font-bold text-blue-900/70 leading-relaxed animate-tip"></p></div>
                </div>
            </div>

            <div id="linksSection" class="space-y-3 pt-4 border-t border-gray-100">
                <label id="labelLinks" class="text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-1">å¤–éƒ¨ãƒªãƒ³ã‚¯ãƒ»é€£æº</label>
                <div class="grid grid-cols-1 gap-2">
                    <button onclick="navExternal('gmaps')" id="btnGmaps" class="action-btn active-base !justify-start px-4">ğŸ“ Google Maps ã§é–‹ã</button>
                    <button onclick="navExternal('directions')" id="btnDirections" class="action-btn !justify-start px-4">ğŸš— ãƒ«ãƒ¼ãƒˆæ¤œç´¢ã‚’é–‹ã</button>
                    <button onclick="navExternal('reviews')" id="btnReviews" class="action-btn !justify-start px-4">â­ ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ã‚¯ãƒã‚³ãƒŸã‚’è¦‹ã‚‹</button>
                    <button id="streetviewBtn" onclick="navExternal('streetview')" class="action-btn !justify-start px-4">ğŸ™ï¸ ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ã§é–‹ã</button>
                    <button id="weatherBtn" onclick="navExternal('weather')" class="action-btn !justify-start px-4">â˜€ï¸ <span id="weatherLabel">ã®å¤©æ°—</span></button>
                    <button onclick="navExternal('earth')" id="btnEarth" class="action-btn !justify-start px-4">ğŸŒ Google Earth ã§é–‹ã</button>
                    <button onclick="navExternal('search')" class="action-btn !justify-start px-4">ğŸ” <span id="searchLabel">ã“ã®å ´æ‰€ã«ã¤ã„ã¦æ¤œç´¢</span></button>
                    <button onclick="navExternal('gsi')" id="btnGsi" class="action-btn !justify-start px-4">ğŸ—¾ å›½åœŸåœ°ç†é™¢åœ°å›³</button>
                </div>
            </div>
        </div>
    </aside>

    <div id="layerMenu" class="glass-panel p-5 absolute top-24 right-6 z-[9999] hidden flex-col gap-5 w-80 rounded-3xl overflow-y-auto max-h-[75vh]">
        <div>
            <label id="labelLangHeader" class="text-[10px] font-black text-blue-500 uppercase tracking-widest block mb-3">Language / è¨€èªè¨­å®š</label>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="changeLanguage('ja')" id="lang-ja" class="action-btn active-base">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</button>
                <button onclick="changeLanguage('en')" id="lang-en" class="action-btn">ğŸ‡ºğŸ‡¸ English</button>
                <button onclick="changeLanguage('zh')" id="lang-zh" class="action-btn">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</button>
                <button onclick="changeLanguage('ko')" id="lang-ko" class="action-btn">ğŸ‡°ğŸ‡· í•œêµ­ì–´</button>
            </div>
        </div>

        <div>
            <label id="labelBase" class="text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-3">åŸºæœ¬åœ°å›³ - ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰</label>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="changeBase('osm')" id="base-osm" class="action-btn active-base">ğŸ—ºï¸ æ¨™æº–</button>
                <button onclick="changeBase('roadmap')" id="base-roadmap" class="action-btn">ğŸš— é“è·¯åœ°å›³</button>
                <button onclick="changeBase('terrain')" id="base-terrain" class="action-btn">â›°ï¸ åœ°å½¢å›³</button>
                <button onclick="changeBase('english')" id="base-english" class="action-btn">ğŸ‡ºğŸ‡¸ è‹±èªåœ°å›³</button>
                <button onclick="changeBase('gsistd')" id="base-gsistd" class="action-btn">ğŸ—¾ åœ°ç†é™¢æ¨™æº–</button>
            </div>
        </div>
        <div>
            <label id="labelMono" class="text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-3">ãƒ¢ãƒãƒˆãƒ¼ãƒ³ãƒ»ç‰¹æ®Š</label>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="changeBase('dark')" id="base-dark" class="action-btn">ğŸ•¶ï¸ ãƒ€ãƒ¼ã‚¯</button>
                <button onclick="changeBase('grayscale')" id="base-grayscale" class="action-btn">âšª ã‚°ãƒ¬ãƒ¼</button>
                <button onclick="changeBase('bw')" id="base-bw" class="action-btn">ğŸ ãƒ¢ãƒã‚¯ãƒ­</button>
                <button onclick="changeBase('lightgray')" id="base-lightgray" class="action-btn">âšª ãƒ©ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼</button>
            </div>
        </div>
        <div>
            <label id="labelCustom" class="text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-3">ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒ</label>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="changeBase('rader_blue')" id="base-rader_blue" class="action-btn">ğŸ“¡ ãƒ–ãƒ«ãƒ¼</button>
                <button onclick="changeBase('rader_dark')" id="base-rader_dark" class="action-btn">ğŸ›°ï¸ ãƒ€ãƒ¼ã‚¯</button>
            </div>
        </div>
        <div>
            <label id="labelSat" class="text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-3">èˆªç©ºå†™çœŸ (Satellite)</label>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="changeBase('satellite_g')" id="base-satellite_g" class="action-btn">ğŸ›°ï¸ è¡›æ˜Ÿå†™çœŸ</button>
                <button onclick="changeBase('satellite_hybrid')" id="base-satellite_hybrid" class="action-btn">ğŸ·ï¸ ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰</button>
                <button onclick="changeBase('gsiortho')" id="base-gsiortho" class="action-btn">ğŸ“¸ åœ°ç†é™¢å†™çœŸ</button>
                <button onclick="changeBase('esri')" id="base-esri" class="action-btn">ğŸŒ Esriè¡›æ˜Ÿ</button>
            </div>
        </div>
        <div>
            <label id="labelOverlay" class="text-[10px] font-black text-gray-400 uppercase tracking-widest block mb-3">ãƒ‡ãƒ¼ã‚¿é‡ã­åˆã‚ã›</label>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="toggleOverlay('hybrid')" id="btn-hybrid" class="action-btn">ğŸ·ï¸ ãƒ©ãƒ™ãƒ«</button>
                <button onclick="toggleOverlay('traffic')" id="btn-traffic" class="action-btn">ğŸš¥ äº¤é€šçŠ¶æ³</button>
                <button onclick="toggleOverlay('transit')" id="btn-transit" class="action-btn">ğŸšƒ é‰„é“ç¶²</button>
                <button onclick="toggleOverlay('eez')" id="btn-eez" class="action-btn">ğŸš¢ çµŒæ¸ˆæ°´åŸŸ</button>
                <button onclick="toggleOverlay('terminator')" id="btn-terminator" class="action-btn">ğŸŒ˜ æ˜¼å¤œ</button>
                <button onclick="toggleOverlay('clock')" id="btn-clock" class="action-btn">ğŸ•’ ä¸–ç•Œæ™‚è¨ˆ</button>
        </div>
    </div>

    <script>
        const apiKey = "";
        let map, marker, currentLat, currentLng, currentLocationName, currentWikiText = "";
        const baseLayers = {};
        const overlays = {};
        let activeBaseId = 'osm';
        let tipInterval;
        let clockControl = null;
        let currentLang = 'ja';

        const MIN_ZOOM = 3;
        const MAX_ZOOM = 19;

        // Short city list for clock demo (reduced)
        const cities = [
            { name: {ja: "æ±äº¬", en: "Tokyo"}, tz: "Asia/Tokyo", lat: 35.6895, lng: 139.6917 },
            { name: {ja: "ãƒ­ãƒ³ãƒ‰ãƒ³", en: "London"}, tz: "Europe/London", lat: 51.5074, lng: -0.1278 },
            { name: {ja: "ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯", en: "New York"}, tz: "America/New_York", lat: 40.7128, lng: -74.0060 },
            { name: {ja: "ã‚·ãƒ‰ãƒ‹ãƒ¼", en: "Sydney"}, tz: "Australia/Sydney", lat: -33.8688, lng: 151.2093 }
        ];

        function init() {
            if (typeof L === 'undefined') return;
            map = L.map('map', {
                center: [35.6812, 139.7671],
                zoom: 5,
                minZoom: MIN_ZOOM,
                maxZoom: MAX_ZOOM,
                zoomControl: true,
                attributionControl: false,
                worldCopyJump: true,
                maxBounds: [[-85, -500], [85, 500]],
                maxBoundsViscosity: 0.1
            });
            map.zoomControl.setPosition('bottomright');
            L.control.scale({ imperial: false, metric: true, position: 'bottomleft' }).addTo(map);

            const tileOptions = { minZoom: MIN_ZOOM, maxZoom: MAX_ZOOM, noWrap: false };
            baseLayers.osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', tileOptions);
            baseLayers.english = L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', tileOptions);
            baseLayers.gsistd = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', tileOptions);
            baseLayers.gsiortho = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/seamlessphoto/{z}/{x}/{y}.jpg', tileOptions);
            baseLayers.dark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', tileOptions);
            baseLayers.lightgray = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', tileOptions);
            baseLayers.esri = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', tileOptions);
            baseLayers.terrain = L.tileLayer('https://mt1.google.com/vt/lyrs=p&x={x}&y={y}&z={z}', tileOptions);
            baseLayers.roadmap = L.tileLayer('https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', tileOptions);
            baseLayers.grayscale = L.tileLayer('https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', { ...tileOptions, className: 'filter-grayscale' });
            baseLayers.bw = L.tileLayer('https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', { ...tileOptions, className: 'filter-bw' });
            baseLayers.rader_blue = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { ...tileOptions, className: 'filter-rader-blue' });
            baseLayers.rader_dark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', tileOptions);
            baseLayers.satellite_g = L.tileLayer('https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', tileOptions);
            baseLayers.satellite_hybrid = L.tileLayer('https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}', tileOptions);

            overlays.hybrid = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png', { zIndex: 1000, ...tileOptions });
            overlays.traffic = L.tileLayer('https://mt1.google.com/vt?lyrs=h@159000000,traffic|seconds_into_week:-1&style=3&x={x}&y={y}&z={z}', { zIndex: 900, opacity: 0.8, ...tileOptions });
            overlays.transit = L.tileLayer('https://{s}.tiles.openrailwaymap.org/standard/{z}/{x}/{y}.png', { zIndex: 920, ...tileOptions });
            overlays.eez = L.tileLayer('https://geo.vliz.be/geoserver/gwc/service/tms/1.0.0/MarineRegions%3Aeez@EPSG%3A900913@png/{z}/{x}/{y}.png', { zIndex: 930, opacity: 0.6, tms: true, ...tileOptions });

            if (typeof L.terminator === 'function') overlays.terminator = L.terminator({ fillOpacity: 0.4, color: '#000814', zIndex: 950 });
            overlays.clock = { enabled: false }; // we'll manage clock UI manually

            // Initialize map with OSM
            baseLayers.osm.addTo(map);

            map.on('click', e => updateUI(e.latlng.lat, e.latlng.lng));
            startTipRotation();
            applyUITranslation();
        }

        // Basic translations (trimmed for brevity)
        const uiTranslations = {
            ja: {
                searchPlaceholder: "å ´æ‰€ã‚’æ¤œç´¢...",
                poiDefault: "å ´æ‰€ã‚’é¸æŠ",
                labelAddr: "ğŸ“ ä½æ‰€",
                labelWiki: "Wikipedia æ¦‚è¦",
                labelWikiMore: "ã‚‚ã£ã¨è¦‹ã‚‹",
                labelQuiz: "AI ã‚¯ã‚¤ã‚º",
                btnRefreshQuiz: "åˆ¥ã®å•é¡Œ",
                quizLoading: "AI ãŒã‚¯ã‚¤ã‚ºã‚’è€ƒãˆã¦ã„ã¾ã™...",
                labelTip: "æ¢ç´¢ã®ãƒ’ãƒ³ãƒˆ",
                labelLinks: "å¤–éƒ¨ãƒªãƒ³ã‚¯ãƒ»é€£æº",
                btnGmaps: "ğŸ“ Google ãƒãƒƒãƒ— ã§é–‹ã",
                btnDirections: "ğŸš— ãƒ«ãƒ¼ãƒˆæ¤œç´¢ã‚’é–‹ã",
                btnReviews: "â­ ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ã‚¯ãƒã‚³ãƒŸã‚’è¦‹ã‚‹",
                btnStreetView: "ğŸ™ï¸ ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ã§é–‹ã",
                btnEarth: "ğŸŒ Google Earth ã§é–‹ã",
                btnGsi: "ğŸ—¾ å›½åœŸåœ°ç†é™¢åœ°å›³",
                weatherSuffix: "ã®å¤©æ°—",
                searchPrefix: "ã“ã®å ´æ‰€ã«ã¤ã„ã¦æ¤œç´¢",
                notFoundMsg: "æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«èª¤å­—ã‚„è„±å­—ãŒãªã„ã‹ã”ç¢ºèªãã ã•ã„ã€‚",
                btnSearchGoogle: "ğŸ” Google æ¤œç´¢ã§æ¢ã™",
                wikiLoader: "Wikipediaã‚’æ¤œç´¢ä¸­...",
                noWikiImage: "Wikipediaç”»åƒãªã—",
                labelLangHeader: "Language / è¨€èªè¨­å®š",
                tips: [
                    "åœ°å›³ä¸Šã®ã©ã“ã‹ã‚’ç›´æ¥ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ãã®å ´æ‰€ã®æƒ…å ±ã‚’ç¬æ™‚ã«å–å¾—ã§ãã¾ã™ã€‚",
                    "ã€Œãƒ¬ã‚¤ãƒ¤ãƒ¼ã€ãƒœã‚¿ãƒ³ã‹ã‚‰ã€å›½åœŸåœ°ç†é™¢ã®åœ°å½¢å›³ã‚„Esriã®è¡›æ˜Ÿå†™çœŸã«åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚",
                    "æ¤œç´¢ã§å ´æ‰€ãŒè¦‹ã¤ã‹ã‚‰ãªã„æ™‚ã¯ã€å¸‚åŒºç”ºæ‘åã‚’è¿½åŠ ã™ã‚‹ã¨ç²¾åº¦ãŒä¸ŠãŒã‚Šã¾ã™ã€‚",
                    "ã€Œãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’ã‚ªãƒ³ã«ã™ã‚‹ã¨ã€é“è·¯åã€æµ·ã€å·ã€å±±è„ˆåãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚"
                ]
            },
            en: {
                searchPlaceholder: "Search locations...",
                poiDefault: "Select a Place",
                labelAddr: "ğŸ“ Address",
                labelWiki: "Wikipedia Summary",
                labelWikiMore: "See more",
                labelQuiz: "AI Quiz",
                btnRefreshQuiz: "New Quiz",
                quizLoading: "AI is thinking...",
                labelTip: "Explorer Tips",
                labelLinks: "External Links",
                btnGmaps: "ğŸ“ Open in Google Maps",
                btnDirections: "ğŸš— Directions",
                btnReviews: "â­ Reviews",
                btnStreetView: "ğŸ™ï¸ Street View",
                btnEarth: "ğŸŒ Google Earth",
                btnGsi: "ğŸ—¾ GSI Map (Japan)",
                weatherSuffix: " Weather",
                searchPrefix: "Search about this place",
                notFoundMsg: "Please check your spelling or try another keyword.",
                btnSearchGoogle: "ğŸ” Search on Google",
                wikiLoader: "Searching Wikipedia...",
                noWikiImage: "No Wikipedia Image",
                labelLangHeader: "Language Settings",
                tips: [
                    "Click anywhere on the map to instantly get information about that location.",
                    "Switch to GSI topographic maps or Esri satellite imagery from the Layers button.",
                    "If a place isn't found, try adding the city or prefecture name for better accuracy.",
                    "Turn on the 'Hybrid' overlay to display road names and labels."
                ]
            }
        };

        function changeLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('[id^="lang-"]').forEach(el => el.classList.remove('active-base'));
            document.getElementById(`lang-${lang}`)?.classList.add('active-base');
            applyUITranslation();
            // update clocks or other language-dependent UI
            if (overlays.clock && overlays.clock.enabled) updateClockControl();
        }

        function applyUITranslation() {
            const t = uiTranslations[currentLang] || uiTranslations['en'];
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            const poiEl = document.getElementById('poiName');
            const poiDefaults = ["å ´æ‰€ã‚’é¸æŠ", "Select a Place", "é€‰æ‹©åœ°ç‚¹", "ì¥ì†Œ ì„ íƒ"];
            if (poiDefaults.includes(poiEl.innerText)) poiEl.innerText = t.poiDefault;

            document.getElementById('labelAddr').innerText = t.labelAddr;
            document.getElementById('labelWiki').innerText = t.labelWiki;
            document.getElementById('wikiLink').innerText = t.labelWikiMore || t.labelWikiMore;
            document.getElementById('labelTip').innerText = t.labelTip || t.labelTip;
            document.getElementById('labelLinks').innerText = t.labelLinks || t.labelLinks;
            document.getElementById('noImageText').innerText = t.noWikiImage || "No Wikipedia Image";
            refreshTip();
        }

        // Side panel controls
        function toggleSidePanel() {
            const panel = document.getElementById('sidePanel');
            panel.classList.toggle('panel-hidden');
        }
        function closeSidePanel() {
            const panel = document.getElementById('sidePanel');
            panel.classList.add('panel-hidden');
        }
        function toggleLayerMenu() {
            const m = document.getElementById('layerMenu');
            m.classList.toggle('hidden');
        }

        // Base layer switching
        function changeBase(id) {
            if (!baseLayers[id]) return;
            // remove active class from base buttons
            document.querySelectorAll('[id^="base-"]').forEach(el => el.classList.remove('active-base'));
            document.getElementById(`base-${id}`)?.classList.add('active-base');

            // remove current base
            if (baseLayers[activeBaseId]) {
                try { map.removeLayer(baseLayers[activeBaseId]); } catch (e) {}
            }
            activeBaseId = id;
            baseLayers[id].addTo(map);
        }

        // Overlay toggles (simple add/remove)
        function toggleOverlay(id) {
            const btn = document.getElementById(`btn-${id}`) || document.getElementById(`btn-${id}`);
            if (id === 'clock') {
                overlays.clock.enabled = !overlays.clock.enabled;
                if (overlays.clock.enabled) {
                    activateClockOverlay();
                    btn?.classList.add('active-overlay');
                } else {
                    deactivateClockOverlay();
                    btn?.classList.remove('active-overlay');
                }
                return;
            }
            if (!overlays[id]) return;
            if (map.hasLayer(overlays[id])) {
                map.removeLayer(overlays[id]);
                btn?.classList.remove('active-overlay');
            } else {
                overlays[id].addTo(map);
                btn?.classList.add('active-overlay');
            }
            // show legend if certain overlays active
            updateLegend();
        }

        function updateLegend() {
            const legend = document.getElementById('legendPanel');
            const content = document.getElementById('legendContent');
            content.innerHTML = '';
            const items = [];
            if (map.hasLayer(overlays.traffic)) items.push({ label: (uiTranslations[currentLang]?.leg_jam || 'Traffic'), color: '#ef4444' });
            if (map.hasLayer(overlays.transit)) items.push({ label: (uiTranslations[currentLang]?.leg_rail || 'Rail'), color: '#1a73e8' });
            if (map.hasLayer(overlays.eez)) items.push({ label: (uiTranslations[currentLang]?.leg_eez || 'EEZ'), color: '#10b981' });
            if (map.hasLayer(overlays.terminator)) items.push({ label: (uiTranslations[currentLang]?.leg_night || 'Night'), color: '#0f172a' });

            if (items.length === 0) {
                legend.classList.add('hidden');
            } else {
                items.forEach(it => {
                    const el = document.createElement('div');
                    el.style.display = 'flex';
                    el.style.alignItems = 'center';
                    el.style.gap = '8px';
                    el.innerHTML = `<div style="width:12px;height:12px;background:${it.color};border-radius:3px;"></div><div>${it.label}</div>`;
                    content.appendChild(el);
                });
                legend.classList.remove('hidden');
            }
        }

        // Clock overlay: simple floating control showing multiple city times
        function activateClockOverlay() {
            if (clockControl) return;
            overlays.clock.enabled = true;
            clockControl = L.control({ position: 'topright' });
            clockControl.onAdd = function() {
                const div = L.DomUtil.create('div', 'glass-panel p-3');
                div.id = 'clockControl';
                div.style.minWidth = '160px';
                div.style.textAlign = 'center';
                updateClockControl(div);
                return div;
            };
            clockControl.addTo(map);
            // update every 30s
            overlays.clock._interval = setInterval(updateClockControl, 30000);
        }
        function deactivateClockOverlay() {
            overlays.clock.enabled = false;
            if (clockControl) {
                try { clockControl.remove(); } catch (e) {}
                clockControl = null;
            }
            if (overlays.clock._interval) {
                clearInterval(overlays.clock._interval);
                overlays.clock._interval = null;
            }
        }
        function updateClockControl(existingDiv) {
            const div = existingDiv || document.getElementById('clockControl');
            if (!div) return;
            const t = uiTranslations[currentLang] || uiTranslations['en'];
            div.innerHTML = `<div class="clock-label"><div style="font-weight:700;font-size:12px;">${t.labelTip || 'Clock'}</div><div style="height:8px;"></div></div>`;
            // build times
            const list = document.createElement('div');
            list.style.marginTop = '6px';
            cities.forEach(c => {
                const dt = new Date();
                // simple timezone conversion using Intl (best-effort)
                let timeStr = dt.toLocaleTimeString(currentLang, { timeZone: c.tz, hour: '2-digit', minute: '2-digit' });
                const name = c.name[currentLang] || c.name.en;
                const row = document.createElement('div');
                row.style.display = 'flex';
                row.style.justifyContent = 'space-between';
                row.style.fontSize = '12px';
                row.style.fontWeight = '700';
                row.style.marginTop = '4px';
                row.innerHTML = `<div style="opacity:0.9">${name}</div><div style="color:#ffd166">${timeStr}</div>`;
                list.appendChild(row);
            });
            div.appendChild(list);
        }

        // Tips rotation
        function startTipRotation() {
            refreshTip();
            if (tipInterval) clearInterval(tipInterval);
            tipInterval = setInterval(refreshTip, 10000);
        }
        function refreshTip() {
            const t = uiTranslations[currentLang] || uiTranslations['en'];
            const tips = t.tips || ["Click on the map to get information."];
            const idx = Math.floor(Math.random() * tips.length);
            document.getElementById('tipText').innerText = tips[idx];
        }

        // Basic search using Nominatim
        async function performSearch() {
            const q = document.getElementById('searchInput').value.trim();
            if (!q) return;
            const lang = currentLang || 'ja';
            const url = `https://nominatim.openstreetmap.org/search?format=json&limit=5&q=${encodeURIComponent(q)}`;
            try {
                const res = await fetch(url, { headers: { 'Accept-Language': lang }});
                const data = await res.json();
                if (!data || data.length === 0) {
                    document.getElementById('notFoundSection').classList.remove('hidden');
                    return;
                }
                const p = data[0];
                map.setView([parseFloat(p.lat), parseFloat(p.lon)], 14);
                updateUI(parseFloat(p.lat), parseFloat(p.lon), p.display_name);
            } catch (e) {
                console.error(e);
            }
        }

        function searchGoogleWeb() {
            const q = document.getElementById('poiName').innerText || document.getElementById('searchInput').value;
            if (!q) return;
            window.open(`https://www.google.com/search?q=${encodeURIComponent(q)}`, '_blank');
        }

        // External navigation helpers
        function navExternal(type) {
            if (!currentLat || !currentLng) return alert('å ´æ‰€ã‚’é¸æŠã—ã¦ãã ã•ã„');
            const lat = currentLat, lng = currentLng;
            switch (type) {
                case 'gmaps':
                    window.open(`https://www.google.com/maps/@${lat},${lng},16z`, '_blank'); break;
                case 'directions':
                    window.open(`https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`, '_blank'); break;
                case 'streetview':
                    window.open(`https://www.google.com/maps?q=&layer=c&cbll=${lat},${lng}`, '_blank'); break;
                case 'earth':
                    window.open(`https://earth.google.com/web/search/${lat},${lng}`, '_blank'); break;
                case 'search':
                    window.open(`https://www.google.com/search?q=${encodeURIComponent(document.getElementById('poiName').innerText)}`, '_blank'); break;
                case 'gsi':
                    // simple GSI zoom
                    window.open(`https://maps.gsi.go.jp/#${lng}/${lat}/16/`, '_blank'); break;
                case 'weather':
                    window.open(`https://www.google.com/search?q=${lat},${lng}+weather`, '_blank'); break;
                default:
                    window.open(`https://www.google.com/search?q=${lat},${lng}`, '_blank'); break;
            }
        }

        // Update UI when a location is selected
        async function updateUI(lat, lng, displayName) {
            currentLat = lat; currentLng = lng;
            document.getElementById('notFoundSection').classList.add('hidden');

            // update marker
            if (marker) {
                marker.setLatLng([lat, lng]);
            } else {
                marker = L.marker([lat, lng]).addTo(map);
            }

            // reverse geocode to get address if not provided
            if (!displayName) {
                try {
                    const rev = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`);
                    const rj = await rev.json();
                    displayName = rj.display_name || `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
                } catch (e) {
                    displayName = `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
                }
            }

            currentLocationName = displayName;
            document.getElementById('poiName').innerText = displayName.split(',')[0] || displayName;
            document.getElementById('addrText').innerText = displayName;
            document.getElementById('poiImageLoader').style.display = 'flex';
            document.getElementById('poiImage').classList.add('hidden');
            document.getElementById('noImagePlaceholder').classList.add('hidden');
            document.getElementById('wikiContainer').classList.add('hidden');

            // Fetch Wikipedia summary & image (best-effort) based on place name
            fetchWikipedia(displayName.split(',')[0]);
            // open side panel to show info
            const panel = document.getElementById('sidePanel');
            panel.classList.remove('panel-hidden');
        }

        // Fetch wikipedia summary & image using MediaWiki API (search then extract)
        async function fetchWikipedia(query) {
            const lang = currentLang || 'ja';
            document.getElementById('loaderText').innerText = uiTranslations[currentLang]?.wikiLoader || 'Searching Wikipedia...';
            try {
                // 1) search for best page match
                const sUrl = `https://${lang}.wikipedia.org/w/api.php?action=query&origin=*&format=json&list=search&srsearch=${encodeURIComponent(query)}&srlimit=1`;
                const sRes = await fetch(sUrl);
                const sJson = await sRes.json();
                if (!sJson.query || sJson.query.search.length === 0) {
                    // no wiki found
                    document.getElementById('poiImageLoader').style.display = 'none';
                    document.getElementById('noImagePlaceholder').classList.remove('hidden');
                    document.getElementById('wikiContainer').classList.add('hidden');
                    return;
                }
                const title = sJson.query.search[0].title;

                // 2) get extract and original image if exists
                const pageUrl = `https://${lang}.wikipedia.org/w/api.php?action=query&origin=*&format=json&prop=extracts|pageimages&exintro=1&piprop=original&titles=${encodeURIComponent(title)}`;
                const pRes = await fetch(pageUrl);
                const pJson = await pRes.json();
                const pages = pJson.query && pJson.query.pages;
                const pageId = Object.keys(pages)[0];
                const page = pages[pageId];
                if (page) {
                    const extract = page.extract ? sanitizeHtmlSnippet(page.extract) : '';
                    const imageUrl = page.original ? page.original.source : null;
                    // update UI
                    document.getElementById('wikiText').innerHTML = extract ? extract : (uiTranslations[currentLang]?.noWikiImage || 'No summary available.');
                    document.getElementById('wikiLink').href = `https://${lang}.wikipedia.org/wiki/${encodeURIComponent(title)}`;
                    document.getElementById('wikiContainer').classList.remove('hidden');
                    if (imageUrl) {
                        const imgEl = document.getElementById('poiImage');
                        imgEl.src = imageUrl;
                        imgEl.onload = () => {
                            document.getElementById('poiImageLoader').style.display = 'none';
                            imgEl.classList.remove('hidden');
                            document.getElementById('noImagePlaceholder').classList.add('hidden');
                        };
                        imgEl.onerror = () => {
                            document.getElementById('poiImageLoader').style.display = 'none';
                            document.getElementById('poiImage').classList.add('hidden');
                            document.getElementById('noImagePlaceholder').classList.remove('hidden');
                        };
                    } else {
                        document.getElementById('poiImageLoader').style.display = 'none';
                        document.getElementById('poiImage').classList.add('hidden');
                        document.getElementById('noImagePlaceholder').classList.remove('hidden');
                    }
                } else {
                    document.getElementById('poiImageLoader').style.display = 'none';
                    document.getElementById('noImagePlaceholder').classList.remove('hidden');
                    document.getElementById('wikiContainer').classList.add('hidden');
                }
            } catch (e) {
                console.error(e);
                document.getElementById('poiImageLoader').style.display = 'none';
                document.getElementById('noImagePlaceholder').classList.remove('hidden');
            }
        }

        // quick sanitizer for excerpt (strip scripts)
        function sanitizeHtmlSnippet(html) {
            // create temporary element and remove scripts
            const div = document.createElement('div');
            div.innerHTML = html;
            const scripts = div.querySelectorAll('script,style');
            scripts.forEach(s => s.remove());
            // limit length slightly
            let text = div.innerHTML;
            if (text.length > 1000) text = text.slice(0, 1000) + '...';
            return text;
        }

        // Simple QA generator placeholder (not AI-connected)
        function generateQuiz() {
            document.getElementById('quizSection').classList.remove('hidden');
            const q = document.getElementById('quizQuestion');
            const opts = document.getElementById('quizOptions');
            q.innerText = 'ã“ã®å ´æ‰€ã®ç·¯åº¦ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ';
            opts.innerHTML = '';
            const correct = currentLat ? currentLat.toFixed(2) : '35.68';
            const choices = [correct, (currentLat ? (currentLat + 1.23).toFixed(2) : '36.91'), (currentLat ? (currentLat - 2.34).toFixed(2) : '33.34')];
            choices.sort(() => Math.random() - 0.5);
            choices.forEach(ch => {
                const b = document.createElement('button');
                b.className = 'quiz-option';
                b.innerText = ch;
                b.onclick = () => {
                    if (ch === correct) {
                        b.classList.add('correct');
                    } else {
                        b.classList.add('incorrect');
                        // mark correct
                        Array.from(opts.children).forEach(c => { if (c.innerText === correct) c.classList.add('correct'); });
                    }
                };
                opts.appendChild(b);
            });
        }

        // init on load
        window.addEventListener('load', () => {
            init();
            // set initial UI language classes
            document.getElementById('lang-ja').classList.add('active-base');
        });

    </script>
</body>
</html>